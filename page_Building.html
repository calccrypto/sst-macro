<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>SST/macro: Building and Running SST/macro</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customthing.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SST/macro
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Building and Running SST/macro </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="sec_buildinstall"></a>
Build and Installation of SST/macro</h1>
<h2><a class="anchor" id="subsec_build_downloading"></a>
Downloading</h2>
<p>SST/macro is available at <a href="http://bitbucket.org/sst-ca/sstmacro">http://bitbucket.org/sst-ca/sstmacro</a>. You can get SST/macro in the following ways:</p>
<ul>
<li>
Download a .tar of a release on the downloads page \ (<a href="bitbucket.org/sst-ca/sstmacro/downloads">bitbucket.org/sst-ca/sstmacro/downloads</a>) </li>
<li>
Download a .tar of the repository on the main overview page </li>
<li>
<p class="startli">Clone the repository with Mercurial.</p>
<p class="endli"></p>
</li>
</ul>
<p>If you're using Mercurial, you can run the command:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ hg clone http://bitbucket.org/sst-ca/sstmacro -r default</div></div><!-- fragment --><p>The <code>-r default</code> only downloads the current development branch and can be omitted if you want to bring in the entire history. The download can take a very long time on some systems to generate the "deltas" in the revision history. You can save yourself a lot of waiting by only downloading the default revision. If you're behind a firewall, make sure the http proxy is set in your ~/.hgrc file:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;[http_proxy]</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;host=path-to-proxy:prox-port </div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;[https_proxy] </div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;host=path-to-proxy:prox-port </div></div><!-- fragment --><p>If you'd like to use ssh for convenience, you'll have to modify your clone slightly by adding the "hg" username: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ hg clone ssh://hg@bitbucket.org/sst-ca/sstmacro</div></div><!-- fragment --><p> and also add your public key to your bitbucket user account. Also, SST/macro uses subrepos, so for using ssh you should add the following to your ~/.hgrc </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;[subpaths]</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;https://bitbucket.org/sst-ca/dumpi = \</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        ssh://hg@bitbucket.org/sst-ca/dumpi</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;https://bitbucket.org/sst-ca/sstmacro-pth = \</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        ssh://hg@bitbucket.org/sst-ca/sstmacro-pth</div></div><!-- fragment --><p> so that the http requests are converted to ssh.</p>
<h2><a class="anchor" id="subsec_build_dependencies"></a>
Dependencies</h2>
<ul>
<li>
A C/C++ compiler is required. gcc 4.2 and onward is known to work. </li>
<li>
(optional, recommended) Qt libraries and build system (qmake) are needed to build the GUI input configuration tool. Qt 5.0 and above are suggested, although 4.9 has been observed in the wild to work (Section <a class="el" href="page_Building.html#sec_building_gui">Building the GUI</a>). </li>
<li>
(optional) Mercurial is needed in order to clone the source code repository, but you can also download a tar (Section <a class="el" href="page_Building.html#subsec_build_downloading">Downloading</a>). </li>
<li>
(optional, recommended) Autoconf and related tools are needed unless you are using an unmodified release or snapshot tar archive. <ul>
<li>
Autoconf: 2.64 or later should work and 2.68 is known to work </li>
<li>
Automake: 1.11 or later should work and 1.11.1 is known to work </li>
<li>
<p class="startli">Libtool: 2.2.6 or later should work and 2.4 is known to work</p>
<p class="endli"></p>
</li>
</ul>
</li>
<li>
(optional) Doxygen and Graphviz are needed to build the documentation. </li>
<li>
(optional) Graphviz is needed to collect call graphs. </li>
<li>
(optional) VTK is needed for advanced vis features. </li>
<li>
<p class="startli">(optional) Python with the argparse module installed is required to run UPC skeletons. Python 2.7 and on should have this.</p>
<p class="endli"></p>
</li>
</ul>
<h2><a class="anchor" id="subsec_build_configure"></a>
Configuration and Building</h2>
<p>For a list of known compatible systems, see in the PDF manual.</p>
<p>Once SST/macro is extracted to a directory, we recommend the following as a baseline configuration, including building outside the source tree:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;sstmacro$ ./bootstrap.sh</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;sstmacro$ mkdir build</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;sstmacro$ cd build</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;sstmacro/build$ ../configure --prefix=/path-to-install </div></div><!-- fragment --><p>A complete list of options can be seen by running `../configure &ndash;help'. Some common options:</p>
<ul>
<li>
&ndash;enable-graphviz : Enables the collection of simulated call graphs, which can be viewed with graphviz. </li>
<li>
&ndash;with-qt=$QMAKE: Direct SST/macro to the qmake executable. If no value is specified, it just assumes qmake is in your $PATH (see Section <a class="el" href="page_Building.html#sec_building_gui">Building the GUI</a>). </li>
<li>
&ndash;enable-custom-new : Memory is allocated in larger chunks in the simulator, which can speed up large simulations. </li>
<li>
&ndash;enable-fortran : Enable support for running fortran skeletons. </li>
<li>
<p class="startli">&ndash;enable-mpiparallel: Enable parallel discrete event simulation in distributed memory over MPI. See Section <a class="el" href="page_Building.html#sec_PDES">Parallel Simulations</a>.</p>
<p class="endli"></p>
</li>
</ul>
<p>Once configuration has completed, printing a summary of the things it found, simply type `make'. It is recommended to use the `-j' option for a parallel build with as many cores as you have (otherwise it will take quite a while).</p>
<h2><a class="anchor" id="subsec_postbuild"></a>
Post-Build</h2>
<p>If the build did not succeed, check <a class="el" href="page_Building.html#subsec_build_issues">Known Issues</a> for known issues, or contact SST/macro support for help (<a href="#" onclick="location.href='mai'+'lto:'+'sst'+'ma'+'cro'+'-s'+'upp'+'or'+'t@g'+'oo'+'gle'+'gr'+'oup'+'s.'+'com'; return false;">sstma<span style="display: none;">.nosp@m.</span>cro-<span style="display: none;">.nosp@m.</span>suppo<span style="display: none;">.nosp@m.</span>rt@g<span style="display: none;">.nosp@m.</span>oogle<span style="display: none;">.nosp@m.</span>grou<span style="display: none;">.nosp@m.</span>ps.co<span style="display: none;">.nosp@m.</span>m</a>).</p>
<p>If the build was successful, it is recommended to run the range of tests to make sure nothing went wrong. To do this, and also install SST/macro to the install path specified during installation, run the following commands:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;sstmacro/build$ make -j8 check</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;sstmacro/build$ sudo make install</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;sstmacro/build$ export PATH=$PATH:/path-to-install</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;sstmacro/build$ make -j8 installcheck</div></div><!-- fragment --><p> Make check runs all the tests we use for development, which checks all functionality of the simulator. Make installcheck compiles some of the skeletons that come with SST/macro, linking against the installation.</p>
<p>Important: After SST/macro is installed, add /path-to-install/bin to your PATH variable (we keep it in our .bashrc, .profile, etc). Applications and other code linking to SST/macro use Makefiles that use the sst++ compiler wrapper that is installed there for convenience to figure out where headers and libraries are. If you are building a skeleton (or running make installcheck) and you get errors along the lines of "can't find
sst++", you probably forgot this step.</p>
<h2><a class="anchor" id="subsec_build_issues"></a>
Known Issues</h2>
<ul>
<li>
Any build or runtime problems should be reported to <a href="#" onclick="location.href='mai'+'lto:'+'sst'+'ma'+'cro'+'-d'+'eve'+'l@'+'goo'+'gl'+'egr'+'ou'+'ps.'+'co'+'m'; return false;">sstma<span style="display: none;">.nosp@m.</span>cro-<span style="display: none;">.nosp@m.</span>devel<span style="display: none;">.nosp@m.</span>@goo<span style="display: none;">.nosp@m.</span>glegr<span style="display: none;">.nosp@m.</span>oups<span style="display: none;">.nosp@m.</span>.com</a>. We try to respond as quickly as possible. </li>
<li>
<p class="startli">make -j: When doing a parallel compile dependency problems can occur. There are a lot of inter-related libraries and files. Sometimes the Makefile dependency tracker gets ahead of itself and you will get errors about missing libraries and header files. If this occurs, restart the compilation. If the error vanishes, it was a parallel dependency problem. If the error persists, then it's a real bug.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Ubuntu: The Ubuntu linker performs too much optimization on dynamically linked executables. Some call it a feature. I call it a bug. In the process it throws away symbols it actually needs later. This occurs when the executable depends on libA which depends on libB. The executable has no direct dependence on any symbols in libB. Even if you add <code>-lB</code> to the <code>LDFLAGS</code> or <code>LDADD</code> variables, the linker ignores them and throws the library out. It takes a dirty hack to force the linkage. If you get weird undefined reference errors, these can usually be removed by including the header file <code>sstmac/force_link.h</code>. If there are issues, contact the developers at <a href="#" onclick="location.href='mai'+'lto:'+'sst'+'ma'+'cro'+'-d'+'eve'+'l@'+'goo'+'gl'+'egr'+'ou'+'ps.'+'co'+'m'; return false;">sstma<span style="display: none;">.nosp@m.</span>cro-<span style="display: none;">.nosp@m.</span>devel<span style="display: none;">.nosp@m.</span>@goo<span style="display: none;">.nosp@m.</span>glegr<span style="display: none;">.nosp@m.</span>oups<span style="display: none;">.nosp@m.</span>.com</a> and report the problem. It can be fixed easily enough.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Compilation with clang should work, although the compiler is very sensitive. In particular, template code which is correct and compiles on several other platforms can mysteriously fail. Tread with caution.</p>
<p class="endli"></p>
</li>
</ul>
<h1><a class="anchor" id="sec_building_dumpi"></a>
Building DUMPI</h1>
<p>By default, DUMPI is configured and built along with SST/macro with support for reading and parsing DUMPI traces, known as libundumpi. DUMPI binaries and libraries are also installed along with everything for SST/macro during make install. DUMPI can be used as it's own library within the SST/macro source tree by changing to <em>sstmacro/dumpi</em>, where you can change its configuration options. It is not recommended to disable libundumpi support, which wouldn't make much sense anyway.</p>
<p>DUMPI can also be used as stand-alone tool/library if you wish (e.g.~for simplicity if you're only tracing). To get DUMPI by itself, either copy the <em>sstmacro/dumpi</em> directory somewhere else or visit <a href="bitbucket.org/sst-ca/dumpi">bitbucket.org/sst-ca/dumpi</a> and follow similar instructions for obtaining SST/macro.</p>
<p>To see a list of configuration options for DUMPI, run `./configure &ndash;help'. If you're trying to configure DUMPI for trace collection, use `&ndash;enable-libdumpi'. Your build process might look like this (if you're building in a separate directory from the dumpi source tree) :</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;dumpi/build$ ../configure --prefix=/path-to-install --enable-libdumpi</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;dumpi/build$ make -j8</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;dumpi/build$ sudo make install</div></div><!-- fragment --><p>Warning: It is possible that the configuration process for DUMPI can take a very long time on network file systems. It basically runs through every MPI function to check its availability/status on your system. If the MPI headers and libraries are not locally available (hard drive) or cached locally, then they will be brought in each time these tests are compiled and run from storage. If storage is a parallel file system, it might be slow.</p>
<h2><a class="anchor" id="subsubsec_building_dumpi_issues"></a>
Known Issues</h2>
<ul>
<li>
<p class="startli">When compiling on platforms with compiler/linker wrappers, e.g. ftn (Fortran) and CC (C++) compilers at NERSC, the libtool configuration can get corrupted. The linker flags automatically added by the wrapper produce bad values for the predeps/postdeps variable in the libtool script in the top level source folder. When this occurs, the (unfortunately) easiest way to fix this is to manually modify the libtool script. Search for predeps/postdeps and set the values to empty. This will clear all the erroneous linker flags. The compilation/linkage should still work since all necessary flags are set by the wrappers.</p>
<p class="endli"></p>
</li>
</ul>
<h1><a class="anchor" id="sec_building_gui"></a>
Building the GUI</h1>
<p>The GUI depends on Qt 5.0 or greater. These can be easily downloaded from the Qt website. To configure SST/macro for compiling the GUI, an additional flag must be added:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;sstmacro/build$ ../configure --prefix=/path-to-install --with-qt=$QMAKE</div></div><!-- fragment --><p> The variable $QMAKE must point to the qmake executable. If qmake is in $PATH, only `&ndash;with-qt' needs to be added. The GUI is compiled independently from SST/macro. In the build directory, just invoke:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;sstmacro/build$ make gui</div></div><!-- fragment --><p> You will see the Qt compilation output followed by output from the source code parser. Keyword input to the GUI is automatically generated from the source code. Once parsing is complete, the GUI is ready to use. The executable is found in the qt-qui folder. On Mac, an application is generated, which can be run:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;sstmacro/build$ open qt-gui/SSTMacro.app</div></div><!-- fragment --><p> On linux, a simple executable is generated.</p>
<h1><a class="anchor" id="sec_tutorial_runapp"></a>
Running an Application</h1>
<p>To demonstrate how an application is run in SST/macro, we'll use a very simple send-recv program located in <em>sstmacro/tutorials/sendrecv_c</em>. We will take a closer look at the actual code in Section <a class="el" href="page_BasicMPITutorial.html#sec_tutorial_basicmpi">Basic MPI Program</a>. After SST/macro has been installed and your PATH variable set correctly, run:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;sstmacro$ cd tutorials/sendrecv_c</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;sstmacro/tutorials/sendrecv_c$ make</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;sstmacro/tutorials/sendrecv_c$ ./runsstmac -f parameters.ini</div></div><!-- fragment --><p>You should see some output that tells you 1) the estimated total (simulated) runtime of the simulation, and 2) the wall-time that it took for the simulation to run. Both of these numbers should be small since it's a trivial program.</p>
<p>This is how simulations generally work in SST/macro: you build skeleton code and link it with the simulator to produce a binary. Then you run that binary and pass it a parameter file which describes the machine model to use.</p>
<h2><a class="anchor" id="subsec_tutorial_makefiles"></a>
Makefiles</h2>
<p>We recommend structuring the Makefile for your project like the one seen in <em>tutorials/sendrecv_c/Makefile</em> :</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;TARGET := runsstmac</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;SRC := $(shell ls *.c) valid_keywords.cc force_link.cc</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;# the sstmacro-config script must be found in PATH</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;CXX :=      $(shell sstmacro-config --cxx )</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;CC :=       $(shell sstmacro-config --cc )</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;CXXFLAGS := $(shell sstmacro-config --cxxflags )</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;CPPFLAGS := $(shell sstmacro-config --cppflags ) -I.</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;LIBDIR :=   $(shell sstmacro-config --libdir )</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;PREFIX :=   $(shell sstmacro-config --prefix )</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;LDFLAGS :=  $(shell sstmacro-config --ldflags )  -Wl,-rpath,$(PREFIX)/lib</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;...</div></div><!-- fragment --><p> The sstmacro-config script is built by the SST/macro configuration process and installed into the bin folder. More linker and include flags can be added for different source trees. For advanced usage in projects built with automate and autoconf, the sstmacro-config script can be invoked in configure.ac following the usage above.</p>
<h2><a class="anchor" id="subsec_tutorial_cprog"></a>
C vs. C++</h2>
<p>The three `sendrecv' skeletons in sstmacro/tutorials show the different usage of C and C++ linking against SST/macro: C, C++ but with a C-style main, and a C++ class that inherits from <em>sstmac::sw::mpiapp</em>. Using C++ inheritance (such as in the <em>sendrecv_cxx2</em> folder) will give you the most flexibility, including the ability to run more than one named application in a single simulation (see Section <a class="el" href="page_ParamsTutorial.html#sec_parameters">SST/macro Parameter files</a> for more info).</p>
<h2><a class="anchor" id="subsec_tutorial_cmdline"></a>
Command-line arguments</h2>
<p>There are only a few basic command-line arguments you'll ever need to use with SST/macro, listed below</p>
<ul>
<li>
-h - print some typical help info </li>
<li>
-f [parameter file] - the parameter file to use for the simulation. This can be relative to the current directory, an absolute path, or the name of a pre-set file that is in sstmacro/configurations (which installs to /path-to-install/include/configurations, and gets searched along with current directory). </li>
<li>
-d [debug flags] - flags that control simulator statistics and output. The general format is -d "&lt;[category]&gt; [flag]", where [category] can be debug, trace, or stats. For example, -d "&lt;debug&gt; mpi" prints out everything MPI is doing. Multiple flags can be appended with $|$, such as -d "&lt;debug&gt; mpi $|$ &lt;trace&gt; dumpi". See in the PDF manual1 for a complete list of flags and what they do. </li>
<li>
-p [parameter]=[value] - setting a parameter value (overrides what is in the parameter file) </li>
<li>
-t [value] - stop the simulation at simulated time [value] </li>
<li>
-c - if debug output is enabled, color-code it by its source (very helpful when parsing lots of input). This uses ANSI escape sequences, so don't use this if you're producing any stats files, or redirecting output to file. Also, this is only really meant to be used on the Mac terminal. </li>
<li>
<p class="startli">-r [run number] - for a parameter file that is enabled for a parameter sweep, run only a specific parameter combination. See Section <a class="el" href="page_ParamsTutorial.html#sec_parameters_multi">Parameter Sweeping with fork()</a>.</p>
<p class="endli"></p>
</li>
</ul>
<h2><a class="anchor" id="sec_PDES"></a>
Parallel Simulations</h2>
<p>SST/macro supports running a parallel discrete event simulation (PDES) in distributed memory over MPI. First, you must configure the simulator with the `&ndash;enable-mpiparallel' flag. Configure will check for MPI and ensure that you're using the standard MPI compilers. Your configure should look something like:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;sstmacro/build $ ../configure --enable-mpiparallel CXX=mpicxx CC=mpicc ...</div></div><!-- fragment --><p>SST/macro also requires METIS for partitioning the workload amongst parallel processes, although in future versions this may no longer be a strict dependency. Make sure you have that installed <code>gpmetis</code> somewhere and the binary is in your PATH. METIS can be found at <a href="http://glaros.dtc.umn.edu/gkhome/metis/metis/download">http://glaros.dtc.umn.edu/gkhome/metis/metis/download</a>. SST/macro is run exactly like the serial version, but is spawned like any other MPI parallel program. Use your favorite MPI launcher to run, e.g. for OpenMPI</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;mysim $ mpirun -n 4 sstmac -f parameters.ini -d &quot;&lt;debug&gt; mpicheck&quot;</div></div><!-- fragment --><p>or for MPICH</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;mysim $ mpiexec -n 4 sstmac -f parameters.ini -d &quot;&lt;debug&gt; mpicheck&quot;</div></div><!-- fragment --><p>A few special configuration options are needed: </p><ul>
<li>
Set the environment variable <code>SSTMAC_PARALLEL=mpi</code>. By default, SST/macro assumes <code>SSTMAC_PARALLEL=serial</code>. </li>
<li>
Add <code>runtime = mpi</code> to the input file. Again, by default, SST/macro assumes <code>runtime = serial</code>. </li>
<li>
<p class="startli">Add <code>event_manager = clock_cycle_parallel</code>. By default, SST/macro uses a serial event map. Currently, only one form of parallelism is supported - conservative, clock-cycle parallelism. More types of parallel event managers may be available in future versions, but this is the only currently supported one. If running on a single processor, <code>clock_cycle_parallel</code> is functionally equivalent to a serial event map.</p>
<p class="endli"></p>
</li>
</ul>
<p>Even if you compile for MPI parallelism, the code can still be run in parallel with the same configuration options. SST/macro will notice the total number of ranks is 1 and ignore any parallel options.</p>
<p>When launched with multiple MPI ranks, SST/macro will automatically figure out how many partitions (MPI processes) you are using, partition the network topology into contiguous blocks, and start running in parallel. If running an MPI program, you should probably be safe and use the `mpicheck' debug flag to ensure the simulation runs to completion. The mpicheck ensures <code>MPI_Finalize</code> is called and the simulation did not "deadlock.'' While the PDES implementation should be stable, it's best to treat it as Beta++ to ensure program correctness.</p>
<p>Parallel simulation may not speed up SST/macro for certain test cases. Most events are scheduled farther into the future than link (synchronization) latency. Since we use the conservative null-message technique, there will be a lot of overhead in synchronizing the clocks. Parallel is most likely to be useful because of memory constraints, expanding the maximum memory footprint. For simulations with serious congestion or heavy interconnect traffic, you may observe speedups, but they will be far from ideal or linear given the synchronization overheads. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>

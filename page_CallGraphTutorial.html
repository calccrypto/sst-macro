<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>SST/macro: Call Graph Visualization</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customthing.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SST/macro
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Call Graph Visualization </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="sec_tutorials_callgraph"></a>
Call Graph Visualization</h1>
<p>Generating call graphs requires a special build of SST/macro.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;build$ ../configure --prefix=$INSTALL_PATH --enable-graphviz</div></div><!-- fragment --><p> The <code>&ndash;enable-graphviz</code> flag defines an instrumentation macro throughout the SST/macro code. This instrumentation must be <em>compiled</em> into SST/macro. In the default build, the instrumentation is not added since the instrumentation has a high overhead. However, SST/macro only instruments a select group of the most important functions so the overhead should only be 10-50%. After installing the instrumented version of SST/macro, a call graph is collected by adding a simple boolean to the parameter file.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;call_graph = true</div></div><!-- fragment --><p> After running, a <code>callgrind.out</code> file should appear in the folder.</p>
<p>To visualize the call graph, you must download KCachegrind: <a href="http://kcachegrind.sourceforge.net/html/Download.html">http://kcachegrind.sourceforge.net/html/Download.html</a>. KCachegrind is built on the KDE environment, which is simple to build for Linux but can be very tedious for Mac. The download also includes a QCachegrind subfolder, providing the same functionality built on top of Qt. This is highly recommended for Mac users.</p>
<p><br />
</p>
<div class="image">
<img src="gui.png" alt="gui.png"/>
</div>
<p> <b>Figure 13:</b> QCachegrind GUI</p>
<p><br />
<br />
</p>
<p>The basic QCachegrind GUI is shown in Figure 13. On the left, a sidebar contains the list of all functions instrumented with the percent of total execution time spent in the function. In the center pane, the call graph is shown. To navigate the call graph, a small window in the bottom right corner can be used to change the view pane. Zooming into one region (Figure 14), we see a set of MPI functions (Barrier, Scan, Allgatherv). Each of the functions enters a polling loop, which dominates the total execution time. A small portion of the polling loop calls the "Handle Socket Header'' function. Double-clicking this node unrolls more details in the call graph (Figure 15). Here we see the function splits execution time between buffering messages (memcpy) and posting headers (Compute Time).</p>
<p><br />
</p>
<div class="image">
<img src="callgraph1.png" alt="callgraph1.png"/>
</div>
<p> <b>Figure 14:</b> QCachegrind Call Graph of MPI Functions</p>
<p><br />
<br />
</p>
<p><br />
</p>
<div class="image">
<img src="callgraph2.png" alt="callgraph2.png"/>
</div>
<p> <b>Figure 15:</b> QCachegrind Expanded Call Graph of Eager 0 Function</p>
<p><br />
<br />
 </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
